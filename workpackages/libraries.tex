\begin{workpackage}[id=libraries,type=RTD,wphases=1-48,
  short={Large libraries},% for Figure 5.
  title={Large libraries},
  lead=Tum,
  StrRM=18,
  ChaRM=12,
  TumRM=27]
%TUM: 3 for AFP/Makarius (25k EUR) - the latter do not generate overheads!

\begin{wpobjectives}
The objective of this WP is to export large dedicated libraries in
curated form to Dedukti and thus to Logipedia for end-user applications.
The focus is \emph{Access} and \emph{Scalability}.
\begin{compactitem}
\item This WP is responsible for supplying the lion's share of proofs in
Logipedia.  As a result it will be a stress test for the results of \WPref{instrumentation}.

\item The target libraries are dedicated to particular application
areas. They provide a substantial coverage of that application area
and do so in a structured manner. This may require reworking the
libraries for better access.

\item The libraries are curated for end-user application. That is, they
are structured according to application specific ontologies that
support browsing and search. The structuring leverages the
infrastructures of \WPref{structuring} and will be a
stress test for the results of that WP.
\end{compactitem}
\end{wpobjectives}


\begin{wpdescription}
Translating the standard libraries of the systems is part of the \WPref{instrumentation}.
This WP focusses on advanced libraries selected according to the following criteria:
relevance, coverage and maturity.
As a result we selected the following libraries: MathComp, Coq's revised
Analysis library, the Archive of Formal Proofs, Isabelle's revised Analysis and Probability library,
GeoCoq, Flyspeck and CakeML. In the future we plan to incorporate
CompCert, seL4, and selected Mizar and PVS libraries (once Mizar and
PVS have reached LIL 2).
\end{wpdescription}


\begin{tasklist}
%\begin{task}[id=mathcomp,title=MathComp]
%\ednote{Sophia, Saclay (Gonthier), Paris}
%\end{task}

%\begin{task}[id=milc,title=Revised Coq Analysis Library]
%\ednote{Saclay (Boldo), Paris, Sophia}
%\end{task}

%\begin{task}[id=mizar,title=The Mizar library]
%\ednote{Innsbruck, Bialystok}
%\end{task}

\begin{task}[
  id=afp,
  title=Isabelle's Archive of Formal Proofs,
  lead=Tum,
  TumRM=3,
  wphases=13-18]
%\ednote{Wenzel}
Isabelle's Archive of Formal Proofs (AFP) \cite{isabelle-afp} is a
growing user-contributed online library for Isabelle. In Feb-2020, the
AFP consisted of more than 500 entries (articles of formalized
mathematics) by 340 authors, and required approx.\ 60h CPU time for
checking (using many gigabytes of memory).  The purpose of this task
is to scale up the Isabelle instrumentation for Dedukti further, to
cover major parts of this library. The ultimate aim is to export the main
substance of the AFP without promising full coverage: some entries
with prohibitive resource requirements will be omitted.
\end{task}

\begin{task}[
  id=isaAnalysisProb,
  title=The Isabelle Analysis \& Probability Theory library,
  lead=Tum,
  TumRM=24,
  wphases=1-24]
%
  This library consists of more than 200.000 lines
  of definitions and proofs, corresponding to almost 4000 printed
  pages. It is fair to say that it is the most advanced
  machine-checked library in the area of analysis and probability
  theory. Because analysis and probability theory are key to many
  applications in enginnering and science, this library will be a key
  exploitable result of the project: it is a fundamental enabling
  resource for almost any formal verification activity in these
  application areas. The purpose of this task is to structure,
  document and develop this library for optimal accessibility, ease of
  use and comprehensiveness.

For better access, the library needs to be modularized, which requires
a significant refactoring effort.  At the same time we need to add
metadata (as provided by \WPref{structuring}) to the source material
to turn this structured collection of theorems and proofs into a
curated library at the Logipedia level.

The following areas of the library need to be developed further. The
library support for integrals is extensive but suffers from the
coexistence of different kinds of integrals. This requires unification
and refactoring. Further essential material for mathematics, physics
and engineering needs to be added: Fourier
analysis and esp.\ the Fourier transform; stability theory for
differential equations and dynamical systems, in particular Lyapunov
functions; stochastic differential equations.
\end{task}

\begin{task}[
  id=geocoq,
  title=The GeoCoq library,
  lead=Str,
  StrRM=18,
  wphases=1-18]
%
The GeoCoq library consists of more than 100.000 lines of definitions and proofs. It is mostly based on synthetic approaches, where the axiom system is based on some geometric objects and axioms about them, but, following Descartes and Tarski, the analytic approach can be derived, where a field F is assumed (usually R) and the space is defined as $F^n$. Moreover, it contains a model of Tarski's axioms, based on the analytic approach, thus establishing the connection between these two approaches in the opposite direction. The main axiom system in this library is the one of Tarski, but Hilbert's axiom system and a version of Euclid's axioms sufficient to prove the propositions in Book 1 of Euclid's Elements are also defined. In the library, the focus is not only on axiom systems but also on axioms themselves. Eleven continuity axioms are available and are hierarchically organised. Finally, it contains a new refinement of Pejasâ€™ classification of parallel postulates together with proofs of the classification of 34 versions of the parallel postulate.

One of the remaining obstacles is the frequent use of computational steps in Coq proofs. The issue is that proofs containing "proof by reflection" reach a level of complexity that makes verification by Dedukti impractical. An approach is to isolate these proofs by reflection so that they are not perceived as simple conversion steps in the type theory proofs, but marked as proofs to be treated by an automatic tool. Another challenge is that CoqInE, a tool developed to translate Coq proofs into Dedukti type-checkable terms, produces terms in a expressing of the Calculus of Inductive Constructions in Dedukti. Currently, it is not possible to export these Dedukti terms to other proof assistant. However, another tool, Universo, has been developed and paves the way for the export of these terms.
\end{task}

\begin{task}[
  id=flyspeck,
  title=The Flyspeck library,
  lead=Inr,
  wphases=1-36]
%\ednote{Saclay (Grienenberger)}
The {HOL Light} library is large and varied. One of its key libraries is the
multivariate analysis library
%\footnote{\url{https://github.com/jrh13/hol-light/tree/master/Multivariate}},
which spans the fields of metric spaces, topology, homology, linear algebra,
convexity, real and complex analysis and transcendentals, derivatives, and
integration. The {Flyspeck} project gives a formal proof of the {Kepler}
conjecture, based on an original proof of Thomas {Hales}
\cite{DBLP:journals/corr/HalesABDHHKMMNNNOPRSTTTUVZ15}, and formalized
largely in {HOL Light} \url{https://github.com/flyspeck/flyspeck}.
Some of these results are not formalized in any other system, motivating the
project of importing the {HOL Light} library and {Flyspeck} project in the
{Dedukti} system, in view of its integration into {Logipedia}.

\textbf{Challenges:}
Proofs coming from the HOL systems, including {HOL Light}, are known to be very
large, adding to the issue of the scalability of exporting software for large
libraries \cite{DBLP:conf/tphol/Wong95,DBLP:conf/cade/ObuaS06,
DBLP:conf/itp/KellerW10,DBLP:conf/cade/Kumar13}. Scalable export techniques
{HOL Light} proofs have been investigated \cite{KaliszykK13} and can provide a
solid base to this project.

The main milestones of this task are the further automation of the export from
{HOL Light} to {Dedukti}, the import of the multivariate analysis library, of
the whole {HOL Light} library, and of the {Flyspeck} in {Dedukti}.
\end{task}

\begin{task}[
  id=cakeml,
  title=The CakeML compiler library,
  lead=Cha,
  ChaRM=12,
  wphases=12-23]
%
The CakeML
compiler \cite{KumarMNO14} (verified with the HOL4 prover) is one of only two verified compilers for real
languages, the other being CompCert. Its export to Dedukti is one of
the KERs of this project.
% Because of the size and importance of this
%library, we will approach the export from two angles.
%
%The first approach utilizes OpenTheory-based technology.
HOL4 can export proofs in the OpenTheory format, which can in turn be
translated into Dedukti. Currently this link from HOL4 via OpenTheory
to Dedukti does not scale to something as sizeable as the CakeML
compiler proof. This part of this task will rework the route via
OpenTheory to scale better, possibly taking inspiration from an
OpenTheory-like approach that scaled well for the HOL light
prover~\cite{KaliszykK13}.

%The second approach establishes a connection from HOL4 via Isabelle to
%Dedukti. The basis is a promising new approach of virtualizing HOL4
%inside Isabelle \cite{ImmlerRW19}. That is, the inference kernel of
%HOL4 is replaced by that of Isabelle and the resulting system produces
%Isabelle theorems instead of HOL4 theorems. As a benchmark of the
%viability of this approach we plan to export CakeML via Isabelle to
%Dedukti.
\end{task}

%\begin{task}[id=unimath,title=The UniMath library]
%\ednote{Birmingham (Ahrens)}
%\end{task}

%\begin{task}[id=pvs,title=The NASA PVS library]
%\end{task}
%\begin{task}[id=sel4,title=The seL4 library]
%\end{task}

%\begin{task}[id=compcert,title=The CompCert library]
%\end{task}
\end{tasklist}

\begin{wpdelivs}
  \begin{wpdeliv}[due=3,id=requirements,dissem=PU,nature=DEM,lead=Inr]
      {Requirements Analysis and Synchronization}
  \end{wpdeliv}
  \begin{wpdeliv}[due=36,id=requirements,dissem=PU,nature=DEM,lead=Tum]
      {Scalable export of proof terms for major parts of Isabelle/AFP}
  \end{wpdeliv}
  \begin{wpdeliv}[due=36,id=requirements,dissem=PU,nature=DEM,lead=Tum]
      {Export of Isabelle's extended analysis and probability theory library}
  \end{wpdeliv}
  \begin{wpdeliv}[due=18,id=geocoq-import,dissem=PU,nature=OTH,lead=Str]
      {Export of most of GeoCoq library}
  \end{wpdeliv}
  \begin{wpdeliv}[due=26,id=requirements,dissem=PU,nature=DEM,lead=Cha]
      {Export of CakeML library}
  \end{wpdeliv}
\end{wpdelivs}
\end{workpackage}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../propB"
%%% End:
